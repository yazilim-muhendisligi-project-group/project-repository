<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/baharkiraathanesi/kiraathane/StockController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/baharkiraathanesi/kiraathane/StockController.java" />
              <option name="originalContent" value="package com.baharkiraathanesi.kiraathane;&#10;&#10;import com.baharkiraathanesi.kiraathane.dao.ProductDAO;&#10;import com.baharkiraathanesi.kiraathane.model.Product;&#10;import javafx.application.Platform;&#10;import javafx.collections.FXCollections;&#10;import javafx.collections.ObservableList;&#10;import javafx.fxml.FXML;&#10;import javafx.scene.control.TableColumn;&#10;import javafx.scene.control.TableView;&#10;import javafx.scene.control.cell.PropertyValueFactory;&#10;import java.util.List;&#10;&#10;public class StockController {&#10;&#10;    @FXML&#10;    private TableView&lt;Product&gt; stockTable;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, String&gt; productNameColumn;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, Integer&gt; stockQuantityColumn;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, Double&gt; priceColumn;&#10;&#10;    private final ProductDAO productDAO = new ProductDAO();&#10;&#10;    @FXML&#10;    public void initialize() {&#10;        System.out.println(&quot;=== StockController Başlatılıyor ===&quot;);&#10;&#10;        // Veri yüklemeyi UI thread'inde yap&#10;        Platform.runLater(this::loadStockData);&#10;    }&#10;&#10;    private void loadStockData() {&#10;        try {&#10;            System.out.println(&quot;Stok verileri yükleniyor...&quot;);&#10;&#10;            // Sütunları konfigür et&#10;            productNameColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;name&quot;));&#10;            stockQuantityColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;stockQty&quot;));&#10;            priceColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;price&quot;));&#10;&#10;            // Veritabanından ürünleri çek&#10;            List&lt;Product&gt; productList = productDAO.getAllProducts();&#10;&#10;            if (productList != null) {&#10;                System.out.println(&quot;✅ &quot; + productList.size() + &quot; ürün bulundu&quot;);&#10;&#10;                // ObservableList'e dönüştür&#10;                ObservableList&lt;Product&gt; products = FXCollections.observableArrayList(productList);&#10;&#10;                // Tabloya ekle&#10;                stockTable.setItems(products);&#10;                System.out.println(&quot;✅ Stok tablosu başarıyla dolduruldu!&quot;);&#10;            } else {&#10;                System.out.println(&quot;❌ Ürün listesi NULL!&quot;);&#10;                stockTable.setItems(FXCollections.observableArrayList());&#10;            }&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ StockController Hatası: &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;    }&#10;&#10;    @FXML&#10;    public void goBackToMenu() {&#10;        System.out.println(&quot;Ana menüye gidiliyor...&quot;);&#10;        HelloApplication.changeScene(&quot;main-menu.fxml&quot;);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.baharkiraathanesi.kiraathane;&#10;&#10;import com.baharkiraathanesi.kiraathane.dao.ProductDAO;&#10;import com.baharkiraathanesi.kiraathane.model.Product;&#10;import javafx.application.Platform;&#10;import javafx.collections.FXCollections;&#10;import javafx.collections.ObservableList;&#10;import javafx.fxml.FXML;&#10;import javafx.scene.control.*;&#10;import javafx.scene.control.cell.PropertyValueFactory;&#10;import javafx.geometry.Insets;&#10;import javafx.scene.layout.GridPane;&#10;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;public class StockController {&#10;&#10;    @FXML&#10;    private TableView&lt;Product&gt; stockTable;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, String&gt; productNameColumn;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, String&gt; categoryColumn;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, Integer&gt; stockQuantityColumn;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, String&gt; unitColumn;&#10;&#10;    @FXML&#10;    private TableColumn&lt;Product, Double&gt; priceColumn;&#10;&#10;    private final ProductDAO productDAO = new ProductDAO();&#10;&#10;    @FXML&#10;    public void initialize() {&#10;        System.out.println(&quot;=== StockController Başlatılıyor ===&quot;);&#10;&#10;        // Çift tıklama ile stok güncelleme&#10;        stockTable.setOnMouseClicked(event -&gt; {&#10;            if (event.getClickCount() == 2) {&#10;                Product selectedProduct = stockTable.getSelectionModel().getSelectedItem();&#10;                if (selectedProduct != null) {&#10;                    updateProductStock(selectedProduct);&#10;                }&#10;            }&#10;        });&#10;&#10;        Platform.runLater(this::loadStockData);&#10;    }&#10;&#10;    @FXML&#10;    private void addNewProduct() {&#10;        Dialog&lt;Product&gt; dialog = new Dialog&lt;&gt;();&#10;        dialog.setTitle(&quot;Yeni Ürün Ekle&quot;);&#10;        dialog.setHeaderText(&quot;Yeni Ürün Bilgilerini Girin&quot;);&#10;&#10;        ButtonType addButtonType = new ButtonType(&quot;Ekle&quot;, ButtonBar.ButtonData.OK_DONE);&#10;        dialog.getDialogPane().getButtonTypes().addAll(addButtonType, ButtonType.CANCEL);&#10;&#10;        GridPane grid = new GridPane();&#10;        grid.setHgap(10);&#10;        grid.setVgap(10);&#10;        grid.setPadding(new Insets(20, 150, 10, 10));&#10;&#10;        TextField nameField = new TextField();&#10;        nameField.setPromptText(&quot;Ürün Adı&quot;);&#10;        TextField categoryField = new TextField();&#10;        categoryField.setPromptText(&quot;Kategori (örn: İçecek)&quot;);&#10;        TextField priceField = new TextField();&#10;        priceField.setPromptText(&quot;Fiyat&quot;);&#10;        TextField stockField = new TextField();&#10;        stockField.setPromptText(&quot;Başlangıç Stok Miktarı&quot;);&#10;        TextField unitField = new TextField();&#10;        unitField.setPromptText(&quot;Birim (örn: Adet, Porsiyon)&quot;);&#10;&#10;        grid.add(new Label(&quot;Ürün Adı:&quot;), 0, 0);&#10;        grid.add(nameField, 1, 0);&#10;        grid.add(new Label(&quot;Kategori:&quot;), 0, 1);&#10;        grid.add(categoryField, 1, 1);&#10;        grid.add(new Label(&quot;Fiyat (TL):&quot;), 0, 2);&#10;        grid.add(priceField, 1, 2);&#10;        grid.add(new Label(&quot;Stok Miktarı:&quot;), 0, 3);&#10;        grid.add(stockField, 1, 3);&#10;        grid.add(new Label(&quot;Birim:&quot;), 0, 4);&#10;        grid.add(unitField, 1, 4);&#10;&#10;        dialog.getDialogPane().setContent(grid);&#10;        Platform.runLater(nameField::requestFocus);&#10;&#10;        dialog.setResultConverter(dialogButton -&gt; {&#10;            if (dialogButton == addButtonType) {&#10;                try {&#10;                    String name = nameField.getText().trim();&#10;                    String category = categoryField.getText().trim();&#10;                    double price = Double.parseDouble(priceField.getText().trim());&#10;                    int stock = Integer.parseInt(stockField.getText().trim());&#10;                    String unit = unitField.getText().trim();&#10;&#10;                    if (name.isEmpty() || category.isEmpty() || unit.isEmpty()) {&#10;                        throw new IllegalArgumentException(&quot;Tüm alanlar doldurulmalıdır!&quot;);&#10;                    }&#10;&#10;                    boolean success = productDAO.addProduct(name, category, price, stock, unit);&#10;                    if (success) {&#10;                        System.out.println(&quot;✅ Yeni ürün eklendi: &quot; + name);&#10;                        loadStockData();&#10;&#10;                        Alert alert = new Alert(Alert.AlertType.INFORMATION);&#10;                        alert.setTitle(&quot;Başarılı&quot;);&#10;                        alert.setContentText(&quot;Ürün başarıyla eklendi!&quot;);&#10;                        alert.showAndWait();&#10;                    }&#10;                } catch (NumberFormatException e) {&#10;                    Alert alert = new Alert(Alert.AlertType.ERROR);&#10;                    alert.setTitle(&quot;Hata&quot;);&#10;                    alert.setContentText(&quot;Fiyat ve stok sayısal değer olmalıdır!&quot;);&#10;                    alert.showAndWait();&#10;                } catch (Exception e) {&#10;                    Alert alert = new Alert(Alert.AlertType.ERROR);&#10;                    alert.setTitle(&quot;Hata&quot;);&#10;                    alert.setContentText(&quot;Hata: &quot; + e.getMessage());&#10;                    alert.showAndWait();&#10;                }&#10;            }&#10;            return null;&#10;        });&#10;&#10;        dialog.showAndWait();&#10;    }&#10;&#10;    @FXML&#10;    private void deleteSelectedProduct() {&#10;        Product selectedProduct = stockTable.getSelectionModel().getSelectedItem();&#10;&#10;        if (selectedProduct == null) {&#10;            Alert alert = new Alert(Alert.AlertType.WARNING);&#10;            alert.setTitle(&quot;Uyarı&quot;);&#10;            alert.setHeaderText(&quot;Ürün Seçilmedi&quot;);&#10;            alert.setContentText(&quot;Lütfen silmek istediğiniz ürünü seçin.&quot;);&#10;            alert.showAndWait();&#10;            return;&#10;        }&#10;&#10;        Alert confirmAlert = new Alert(Alert.AlertType.CONFIRMATION);&#10;        confirmAlert.setTitle(&quot;Ürün Sil&quot;);&#10;        confirmAlert.setHeaderText(&quot;Ürünü silmek istediğinize emin misiniz?&quot;);&#10;        confirmAlert.setContentText(selectedProduct.getName() + &quot; silinecek. Bu işlem geri alınamaz!&quot;);&#10;&#10;        Optional&lt;ButtonType&gt; result = confirmAlert.showAndWait();&#10;        if (result.isPresent() &amp;&amp; result.get() == ButtonType.OK) {&#10;            boolean success = productDAO.deleteProduct(selectedProduct.getId());&#10;&#10;            if (success) {&#10;                System.out.println(&quot;✅ Ürün silindi: &quot; + selectedProduct.getName());&#10;                loadStockData();&#10;&#10;                Alert alert = new Alert(Alert.AlertType.INFORMATION);&#10;                alert.setTitle(&quot;Başarılı&quot;);&#10;                alert.setContentText(&quot;Ürün başarıyla silindi!&quot;);&#10;                alert.showAndWait();&#10;            } else {&#10;                Alert alert = new Alert(Alert.AlertType.ERROR);&#10;                alert.setTitle(&quot;Hata&quot;);&#10;                alert.setContentText(&quot;Ürün silinirken bir hata oluştu!&quot;);&#10;                alert.showAndWait();&#10;            }&#10;        }&#10;    }&#10;&#10;    private void updateProductStock(Product product) {&#10;        TextInputDialog dialog = new TextInputDialog(String.valueOf(product.getStockQty()));&#10;        dialog.setTitle(&quot;Stok Güncelle&quot;);&#10;        dialog.setHeaderText(product.getName() + &quot; için yeni stok miktarı&quot;);&#10;        dialog.setContentText(&quot;Yeni stok miktarı:&quot;);&#10;&#10;        Optional&lt;String&gt; result = dialog.showAndWait();&#10;        result.ifPresent(newStock -&gt; {&#10;            try {&#10;                int stockAmount = Integer.parseInt(newStock.trim());&#10;                if (stockAmount &lt; 0) {&#10;                    throw new IllegalArgumentException(&quot;Stok miktarı negatif olamaz!&quot;);&#10;                }&#10;&#10;                boolean success = productDAO.updateProductStock(product.getId(), stockAmount);&#10;                if (success) {&#10;                    System.out.println(&quot;✅ Stok güncellendi: &quot; + product.getName() + &quot; -&gt; &quot; + stockAmount);&#10;                    loadStockData();&#10;&#10;                    Alert alert = new Alert(Alert.AlertType.INFORMATION);&#10;                    alert.setTitle(&quot;Başarılı&quot;);&#10;                    alert.setContentText(&quot;Stok başarıyla güncellendi!&quot;);&#10;                    alert.showAndWait();&#10;                }&#10;            } catch (NumberFormatException e) {&#10;                Alert alert = new Alert(Alert.AlertType.ERROR);&#10;                alert.setTitle(&quot;Hata&quot;);&#10;                alert.setContentText(&quot;Geçerli bir sayı girin!&quot;);&#10;                alert.showAndWait();&#10;            } catch (Exception e) {&#10;                Alert alert = new Alert(Alert.AlertType.ERROR);&#10;                alert.setTitle(&quot;Hata&quot;);&#10;                alert.setContentText(&quot;Hata: &quot; + e.getMessage());&#10;                alert.showAndWait();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void loadStockData() {&#10;        try {&#10;            System.out.println(&quot;Stok verileri yükleniyor...&quot;);&#10;&#10;            // Sütunları konfigür et&#10;            productNameColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;name&quot;));&#10;            categoryColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;category&quot;));&#10;            stockQuantityColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;stockQty&quot;));&#10;            unitColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;unit&quot;));&#10;            priceColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;price&quot;));&#10;&#10;            // Veritabanından ürünleri çek&#10;            List&lt;Product&gt; productList = productDAO.getAllProducts();&#10;&#10;            if (productList != null) {&#10;                System.out.println(&quot;✅ &quot; + productList.size() + &quot; ürün bulundu&quot;);&#10;&#10;                // ObservableList'e dönüştür&#10;                ObservableList&lt;Product&gt; products = FXCollections.observableArrayList(productList);&#10;&#10;                // Tabloya ekle&#10;                stockTable.setItems(products);&#10;                System.out.println(&quot;✅ Stok tablosu başarıyla dolduruldu!&quot;);&#10;            } else {&#10;                System.out.println(&quot;❌ Ürün listesi NULL!&quot;);&#10;                stockTable.setItems(FXCollections.observableArrayList());&#10;            }&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ StockController Hatası: &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;        }&#10;    }&#10;&#10;    @FXML&#10;    public void goBackToMenu() {&#10;        System.out.println(&quot;Ana menüye gidiliyor...&quot;);&#10;        HelloApplication.changeScene(&quot;main-menu.fxml&quot;);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>